<!DOCTYPE html>
<html lang="en">
<head>
    <th:block th:replace="/admin/common/head.html"></th:block>
    <script src="https://code.jquery.com/jquery-3.7.1.slim.min.js" integrity="sha256-kmHvs0B+OpCW5GVHUNjv9rOmY0IvSIRcf7zGUDTDQM8=" crossorigin="anonymous"></script>
    <script>
        $(function(){
            // 마케팅동의
            let agree = $(".agree").data('agree');
            if(agree.includes('문자')) $("#agreeSms").prop("checked", true);
            if(agree.includes('이메일')) $("#agreeEmail").prop("checked", true);
            // 수정
            $(".editBtn").hide();
            // $("input").change(function(){
            //     $(".editBtn").show();
            // })
            $("input").on("propertychange change keyup paste input", function() {
                $(".editBtn").show();
            })
        })
    </script>
</head>
<body>
<body class="sb-nav-fixed">
<th:block th:replace="/admin/common/header.html"></th:block>
<div id="layoutSidenav">
    <th:block th:replace="/admin/common/sideNav.html"></th:block>
    <div id="layoutSidenav_content">
        <main>
            <div class="container-fluid px-4">
                <h1 class="mt-4">회원 상세</h1>
                <form action="/admin/member/modify" method="post">
                    <table class="datatable-table mt-4">
                        <colgroup>
                            <col style="width:15%"/>
                            <col style="width:*%"/>
                            <col style="width:15%"/>
                            <col style="width:*%"/>
                        </colgroup>
                        <tbody>
                            <tr>
                                <th scope="row">이름</th>
                                <td th:text="${member.name}"></td>
                                <th scope="row">아이디</th>
<!--                                <td th:text="${member.id}"></td>-->
                                <td>
                                    <input class="none" type="text" name="id" th:value="${member.id}" readonly/>
                                </td>
                            </tr>
                            <tr>
                                <th scope="row">생년월일</th>
                                <td th:text="${member.birth}"></td>
                                <th scope="row">성별</th>
                                <td th:text="${member.gender}"></td>
                            </tr>
                            <tr>
                                <th scope="row">휴대폰번호</th>
                                <td><input type="text" name="phone" th:value="${member.phone}" required/></td>
                                <th scope="row">가입날짜</th>
                                <td th:text="${member.joindate}"></td>
                            </tr>
                            <tr>
                                <th scope="row">이메일</th>
                                <td><input type="email" name="email" th:value="${member.email}" required/></td>
                                <th scope="row">마케팅동의</th>
                                <td class="agree" th:data-agree="${member.agree}">
                                    <label class="me-3"><input id="agreeSms" type="checkbox" name="agree" value="sms"> 문자</label>
                                    <label><input id="agreeEmail" type="checkbox" name="agree" value="email"> 이메일</label>
                                </td>
                            </tr>
                            <tr>
                                <th scope="row">
                                    주소<br/>
                                    <a class="deleteAdd btn btn-outline-dark btn-sm mt-1" href="/admin/member/deleteAddress">주소삭제</a>
                                </th>
                                <td colspan="3">
                                    <input type="text" id="address1" name="address1" th:value="${member.address1}" size="20" placeholder="우편번호" readonly>
                                    <input type="button" id="searchZipCode" class="btn btn-success btn-sm" value="우편번호 찾기">
                                    <div class="mt-1">
                                        <input type="text" id="address2" name="address2" th:value="${member.address2}" size="30" placeholder="주소" readonly>
                                        <input type="text" id="address3" name="address3" th:value="${member.address3}" size="30" placeholder="상세주소">
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="text-end">
                        <input type="submit" class="editBtn btn btn-primary" value="수정"/>
                        <a class="btn btn-secondary" href="/admin/member/memberList">목록</a>
                        <a class="btn btn-dark" href="">비밀번호 초기화</a>
                    </div>
                </form>
            </div>
        </main>
    </div>
</div>
<th:block th:replace="/admin/common/foot.html"></th:block>
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script>
    const $searchZipCode = document.getElementById("searchZipCode");
    $searchZipCode.onclick = function(){
        new daum.Postcode({
            oncomplete: function(data) {
                document.getElementById("address1").value = data.zonecode;
                document.getElementById("address2").value = data.address;
                document.getElementById("address3").focus();
            }
        }).open();
    }
</script>
</body>
</html>